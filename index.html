<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="Improve your typing speed and accuracy with free tests, games, and typing tips. Fun for all levels, from beginners to pros!">
  <title>Typing Speed Hub</title>
  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Typing Speed Hub",
  "url": "https://typingspeedhub.com",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://typingspeedhub.com/search?q={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>

  <style>

    :root{
      /* A gépelő doboz és a „My results” szélessége */
      --panel-width: 800px; /* állítható: 760 / 800 / 840 px */
    }

    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #0d0d0d;
      color: #00ff66;
      background-image: radial-gradient(#00ff66 1px, transparent 1px);
      background-size: 20px 20px;
      /* hely a zászlóknak + a fix oldalsó listáknak */
      padding-top: 96px;
    }

    h1 {
      text-align: center;
      margin-top: .4rem; /* közelebb a zászlókhoz */
      font-size: 2.6rem;
    }
    a { color: #00ff66; text-decoration: underline; }

    /* Bal/jobb oldali listák – fix két szélen, nem nyomják le a közepet */
    .top-links {
      position: fixed;
      top: 56px;                 /* a zászlók alatt */
      left: 0; right: 0;
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      padding: 0 2rem;
      pointer-events: none;      /* a konténer ne fogja meg a kattintást */
      z-index: 400;
    }
    .top-links > div {
      width: 280px;
      pointer-events: auto;      /* a linkek kattinthatók maradnak */
      text-align: left;
    }
    .top-links > div:last-child { text-align: right; }

    /* nagyobb betűk a listákhoz */
    .top-links strong { font-size: 1.6rem; letter-spacing: .01em; }
    .top-links a     { font-size: 1.25rem; line-height: 2rem; display: inline-block; font-weight: 600; }

    .typing-test {
      background-color: #1e1e1e;
      padding: 1.5rem;
      border-radius: 10px;
      box-shadow: 0 0 15px #00ff66;
      max-width: var(--panel-width) !important;   /* nagyobb doboz */
      margin: .35rem auto .75rem;                 /* feljebb húzva */
    }
    select, button, textarea {
      margin: 0.5rem 0;
      padding: .6rem;                /* kicsit nagyobb */
      font-size: 1.08rem;            /* kicsit nagyobb */
      width: 100%;
      background-color: #0d0d0d;
      color: #00ff66;
      border: 1px solid #00ff66;
      border-radius: 5px;
    }
    #sentenceDisplay { font-size: 1.16rem; }
    #timerDisplay, #resultDisplay { font-size: 1.06rem; }

    button:hover { background-color: #00ff66; color: #0d0d0d; cursor: pointer; }
    textarea { height: 100px; }
    .hidden { display: none; }

    #footer { text-align: center; margin: 2rem auto; font-size: 0.9rem; }

    /* Nyelvváltó – felül középen, saját kis zászló SVG-kkel */
    .langbar {
      position: fixed;
      top: 8px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: .5rem;
      z-index: 1000;
    }
    .langbar a {
      display: inline-flex;
      align-items: center;
      gap: .35rem;
      border: 1px solid #00ff66;
      padding: .18rem .48rem;
      border-radius: 999px;
      text-decoration: none;
      color: #00ff66;
      background: transparent;
      line-height: 1;
    }
    .langbar a:hover,
    .langbar a.active { background: #00ff66; color: #0d0d0d; }
    .flag {
      width: 20px; height: 14px; border: 1px solid #0d0d0d; box-shadow: 0 0 1px #0d0d0d;
      display: inline-block;
    }

    /* ===== Eredmények táblázat (stílus) ===== */
    #results{
      max-width: var(--panel-width) !important;  /* egyezzen a typing panellel */
      margin: .5rem auto 1.25rem;
      background: #1e1e1e;
      box-shadow: 0 0 15px #00ff66;
      border-radius: 10px;
      padding: 1rem;
    }
    #results h2{ margin: 0 0 1rem; text-align: center; }
    .results-controls{ display:flex; gap:.5rem; justify-content:center; margin-bottom:.75rem; }
    #results button{
      background:#0d0d0d; color:#00ff66; border:1px solid #00ff66; border-radius:6px;
      padding:.4rem .7rem; cursor:pointer;
    }
    #results button:hover{ background:#00ff66; color:#0d0d0d; }
    #resultsTable{ width:100%; border-collapse:collapse; font-size:.95rem; }
    #resultsTable th, #resultsTable td{
      border:1px solid #00ff66; padding:.45rem .5rem; text-align:left;
    }
    #resultsTable thead th{ background:#0d0d0d; }

    /* ===== Mobil: ne legyen fix, álljon vissza normálra ===== */
    @media (max-width: 900px){
      .top-links{
        position: static;
        flex-direction: column;
        gap: .5rem;
        padding: 0 1rem;
        pointer-events: auto;
      }
      .top-links > div{ width: auto; text-align: left; }
      .top-links strong{ font-size: 1.25rem; }
      .top-links a{ font-size: 1.05rem; line-height: 1.6rem; }
      .typing-test, #results { max-width: 100% !important; margin: 1rem; }
      .langbar a{ padding: .16rem .44rem; font-size: .9rem; }
      body{ padding-top: 56px; } /* mobilon csak a zászlóknak kell hely */
    }

    /* Footer – Facebook badge */
    #footer .social { margin:.5rem 0; }
    #footer .fb-badge{
      display:inline-flex; align-items:center; gap:.4rem;
      border:1px solid #00ff66; border-radius:999px;
      padding:.2rem .55rem; color:#00ff66; text-decoration:none;
    }
    #footer .fb-badge:hover{ background:#00ff66; color:#0d0d0d; }
    #footer .fb-icon{ width:18px; height:18px; fill: currentColor; }
  </style>
</head>
<body>

  <!-- Nyelvváltó (középen felül) -->
  <div class="langbar">
    <a href="?lang=en" data-lang="en" aria-label="English">
      <!-- UK ~ egyszerűsített Union Jack -->
      <svg class="flag" viewBox="0 0 60 40" aria-hidden="true">
        <rect width="60" height="40" fill="#012169"/>
        <rect x="24" width="12" height="40" fill="#fff"/>
        <rect y="14" width="60" height="12" fill="#fff"/>
        <rect x="27" width="6" height="40" fill="#C8102E"/>
        <rect y="17" width="60" height="6" fill="#C8102E"/>
        <polygon fill="#fff" points="0,0 8,0 60,30 60,40 52,40 0,10"/>
        <polygon fill="#fff" points="60,0 52,0 0,30 0,40 8,40 60,10"/>
        <polygon fill="#C8102E" points="60,0 46,0 60,8"/>
        <polygon fill="#C8102E" points="0,0 0,8 14,0"/>
        <polygon fill="#C8102E" points="60,40 60,32 46,40"/>
        <polygon fill="#C8102E" points="0,40 14,40 0,32"/>
      </svg>
      EN
    </a>
    <a href="?lang=hu" data-lang="hu" aria-label="Magyar">
      <!-- Hungary -->
      <svg class="flag" viewBox="0 0 3 2" aria-hidden="true">
        <rect width="3" height="2" fill="#fff"/>
        <rect width="3" height="0.6667" y="0" fill="#CE2939"/>
        <rect width="3" height="0.6667" y="1.3333" fill="#477050"/>
      </svg>
      HU
    </a>
    <a href="?lang=de" data-lang="de" aria-label="Deutsch">
      <!-- Germany -->
      <svg class="flag" viewBox="0 0 3 2" aria-hidden="true">
        <rect width="3" height="2" fill="#ffce00"/>
        <rect width="3" height="0.6667" y="0" fill="#000"/>
        <rect width="3" height="0.6667" y="0.6667" fill="#DD0000"/>
      </svg>
      DE
    </a>
   </div>

  <div class="top-links">
  <div>
    <strong>Articles</strong><br/>
    <a href="10-minute-typing-drill.html">10-minute typing drill</a><br/>
    <a href="7-day-typing-plan.html">7-day typing plan</a><br/>
    <a href="best-free-typing-games.html">Best free typing games</a><br/>
    <a href="best-keyboards-typing-practice.html">Best keyboards for typing</a><br/>
    <a href="common-typing-mistakes.html">Common typing mistakes</a><br/>
    <a href="how-typing-improves-focus-memory.html">Typing &amp; memory</a><br/>
    <a href="increase-typing-speed-7days.html">Speed up in 7 days</a><br/>
    <a href="typing-for-kids.html">Typing for kids</a><br/>
    <a href="typing-tips.html">Typing tips</a><br/>
    <a href="what-is-wpm.html">What is WPM?</a><br/>
    <a href="what-is-a-good-wpm-by-age-and-job.html">Good WPM by age &amp; job</a><br/>
    <a href="typing-speed-test.html">Typing Speed Test</a><br/>
    <a href="typing-accuracy-tips.html">Typing Accuracy Tips</a><br/>
    <a href="10-ways-to-improve-typing-speed.html">10 ways to improve typing speed</a><br/>
    <a href="average-typing-speed-statistics-2024.html">
      Average typing speed statistics (2024)
    </a><br/>
  </div>

  <div>
    <strong>Info</strong><br/>
    <a href="about.html">About</a><br/>
    <a href="contact.html">Contact</a><br/>
    <a href="privacy-policy.html">Privacy Policy</a><br/>
    <a href="terms-and-conditions.html">Terms &amp; Conditions</a><br/>
    <a href="impressum.html">Impressum</a>
  </div>
</div>

<h1>Typing Speed Hub</h1>


  <div class="typing-test">
    <label for="langSelect">Language:</label>
    <select id="langSelect" onchange="setLanguage(this.value)">
      <option value="en">English</option>
      <option value="de">Deutsch</option>
      <option value="hu">Magyar</option>
    </select>

    <label for="levelSelect">Level:</label>
    <select id="levelSelect">
      <option value="beginner">Beginner</option>
      <option value="intermediate">Intermediate</option>
      <option value="advanced">Advanced</option>
    </select>

    <label for="durationSelect">Test duration:</label>
    <select id="durationSelect">
      <option value="60">1 minute</option>
      <option value="300">5 minutes</option>
    </select>

    <button onclick="startTest()">Start</button>
    <button type="button" onclick="finishTest()" id="finishBtn" class="hidden">Finish</button>

    <p id="timerDisplay"></p>
    <p id="sentenceDisplay"></p>
    <textarea id="inputArea" class="hidden" placeholder="Start typing here..."></textarea>
    <p id="resultDisplay"></p>
  </div>

  <!-- My results a gépelő doboz alatt -->
  <div id="results">
    <h2>My results</h2>
    <div class="results-controls">
      <button type="button" onclick="exportResultsCSV()">Export CSV</button>
      <button type="button" onclick="clearResults()">Clear</button>
    </div>
    <table id="resultsTable">
      <thead>
        <tr>
          <th>Date</th><th>Lang</th><th>Level</th><th>Duration</th><th>WPM</th><th>Accuracy</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <div id="footer">
    <p>Follow us:</p>
    <p class="social">
      <a class="fb-badge"
         href="https://www.facebook.com/typingspeedhub"
         target="_blank" rel="noopener noreferrer"
         aria-label="Typing Speed Hub on Facebook">
        <svg class="fb-icon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M22 12a10 10 0 1 0-11.6 9.9v-7H7.9V12h2.5V9.8c0-2.5 1.5-3.9 3.8-3.9 1.1 0 2.3.2 2.3.2v2.6h-1.3c-1.3 0-1.7.8-1.7 1.6V12h2.9l-.5 2.9h-2.4v7A10 10 0 0 0 22 12z"/>
        </svg>
        Facebook
      </a>
    </p>
    <p>&copy; 2025 Typing Speed Hub. All rights reserved.</p>
  </div>

  <script>
  let currentLang = 'en';
  let currentSentence = "";
  let startTime, timerInterval;

  const sentences = {
    en: {
      beginner: ["Typing is fun and useful.",
                 "Practice makes perfect.",
                 "Use all your fingers to type.",
                 "Keep your eyes on the screen.",
                 "Do not look at the keyboard.",
                 "Type slowly and carefully.",
                 "Sit up straight while typing.",
                 "Use backspace only when needed.",
                 "Try not to make mistakes.",
                 "Start with short sentences.",
                 "Repeat each exercise often.",
                 "Accuracy is more important than speed.",
                 "Take short breaks between sessions.",
                 "Use both hands when typing.",
                 "Typing gets easier with time.",
                 "Focus on hitting the right keys."
      ],
      intermediate: ["Typing helps improve brain-hand coordination.",
                     "Daily practice leads to real improvement.",
                     "Type full sentences to build fluency.",
                     "Avoid looking at the keyboard while typing.",
                     "Focus on consistency, not just speed.",
                     "Make accuracy your top priority.",
                     "Typing tests are great for tracking progress.",
                     "Use online tools to measure your WPM.",
                     "Practice with longer and more complex texts.",
                     "Avoid using backspace too often.",
                     "Build muscle memory through repetition.",
                     "Stretch your hands before and after typing.",
                     "Type without pausing to think about keys.",
                     "Use varied content to challenge yourself.",
                     "Stay relaxed and maintain good posture.",
                     "Track your mistakes and correct them consciously."
      ],
      advanced: ["Touch typing boosts creativity.",
                 "Advanced typing frees your focus for thinking.",
                 "Typing fluently supports deep work.",
                 "High WPM is essential for professional writing.",
                 "Typing without looking increases mental flow.",
                 "Mastery of typing reduces cognitive load.",
                 "Fast typing enables quicker content creation.",
                 "Typing with rhythm improves clarity and tone.",
                 "Experienced typists correct errors on the fly.",
                 "Long typing sessions feel effortless over time.",
                 "Keyboard shortcuts boost typing productivity.",
                 "Fluent typing supports real-time collaboration.",
                 "Typing speed supports multitasking and flow.",
                 "Typing becomes second nature with practice.",
                 "Typing mastery enhances digital communication.",
                 "Expert typists rarely think about the keyboard."
      ]
    },
    de: {
      beginner: ["Übung macht den Meister.",
                 "Tägliches Tippen verbessert deine Fähigkeiten.",
                 "Benutze alle Finger beim Tippen.",
                 "Halte die Augen auf dem Bildschirm.",
                 "Schau nicht auf die Tastatur.",
                 "Tippe langsam und präzise.",
                 "Sitze beim Tippen gerade.",
                 "Nutze die Rücktaste nur bei Bedarf.",
                 "Vermeide Tippfehler bewusst.",
                 "Beginne mit kurzen Sätzen.",
                 "Wiederhole jede Übung regelmäßig.",
                 "Genauigkeit ist wichtiger als Geschwindigkeit.",
                 "Mach kurze Pausen zwischen den Übungen.",
                 "Verwende beide Hände beim Tippen.",
                 "Tippen wird mit der Zeit einfacher."
      ],
      intermediate: ["Zehnfingersystem verbessert deine Ausdrucksfähigkeit.",
                     "Übung macht dich schneller und genauer.",
                     "Tippe vollständige Sätze zur Übung.",
                     "Vermeide es, auf die Tastatur zu schauen.",
                     "Konzentriere dich auf gleichmäßiges Tippen.",
                     "Genauigkeit ist dein wichtigstes Ziel.",
                     "Nimm regelmäßig an Tipp-Tests teil.",
                     "Verfolge deine Tippgeschwindigkeit online.",
                     "Tippe komplexere Texte zur Herausforderung.",
                     "Verwende die Rücktaste nur bei Fehlern.",
                     "Wiederholung führt zu Muskelgedächtnis.",
                     "Dehne deine Finger vor dem Üben.",
                     "Vermeide Pausen beim Schreiben.",
                     "Nutze verschiedene Inhalte zum Lernen.",
                     "Bleib locker und halte eine gute Haltung."
      ],
      advanced: ["Flüssiges Tippen unterstützt kreatives Denken.",
                 "Schnelles Tippen erleichtert komplexe Aufgaben.",
                 "Tastenkombinationen steigern deine Effizienz.",
                 "Tippen ohne Blick auf die Tastatur spart Zeit.",
                 "Experten korrigieren Fehler im Fluss.",
                 "Gutes Tippen entlastet dein Gehirn.",
                 "Profis schreiben mit Rhythmus und Tempo.",
                 "Lange Tipp-Sessions werden mühelos.",
                 "Erfahrene Nutzer beherrschen Tastaturkürzel.",
                 "Multitasking gelingt besser mit Tippgeschick.",
                 "Tippen unterstützt kollaboratives Arbeiten.",
                 "Flüssiges Tippen fördert den Arbeitsfluss.",
                 "Textverarbeitung wird schneller und einfacher.",
                 "Gutes Tippen erhöht die Konzentration.",
                 "Tippen wird zur zweiten Natur."
      ]
    },
    hu: {
      beginner: ["Használd az összes ujjad gépeléskor.",
                 "A gyakorlás teszi a mestert.",
                 "A gépelés szórakoztató és hasznos.",
                 "Tartsd a szemed a képernyőn.",
                 "Ne nézd a billentyűzetet.",
                 "Gépelj lassan és figyelmesen.",
                 "Ülj egyenesen gépelés közben.",
                 "Használd a törlést csak ha szükséges.",
                 "Próbáld elkerülni a hibákat.",
                 "Kezdj rövid mondatokkal.",
                 "Ismételd meg gyakran a gyakorlatokat.",
                 "A pontosság fontosabb mint a sebesség.",
                 "Tarts rövid szüneteket a gyakorlások között.",
                 "Használd mindkét kezed a gépeléshez.",
                 "A gépelés idővel könnyebbé válik."
      ],
      intermediate: ["A tízujjas gépelés segít a gondolatok gyors kifejezésében.",
                     "A napi gyakorlás látványos fejlődést hoz.",
                     "Gépelj teljes mondatokat a folyékonyságért.",
                     "Kerüld a billentyűzet nézegetését.",
                     "Koncentrálj az egyenletes ritmusra.",
                     "A pontosság mindig legyen elsődleges.",
                     "Tipp tesztek segítenek mérni a haladást.",
                     "Használj online eszközöket a WPM méréséhez.",
                     "Gyakorolj hosszabb és összetettebb szövegekkel.",
                     "Ne használd túl sokszor a törlést.",
                     "Ismétlés által fejlődik az izommemória.",
                     "Nyújtsd le az ujjaid gépelés előtt és után.",
                     "Ne állj meg gépelés közben gondolkodni.",
                     "Használj változatos szövegeket a kihíváshoz.",
                     "Maradj nyugodt és tarts helyes testtartást."
      ],
      advanced: ["A gördülékeny gépelés támogatja a kreatív gondolkodást.",
                 "A profi gépelés segíti az elmélyült munkát.",
                 "A gyors gépelés elengedhetetlen a hatékony íráshoz.",
                 "Gépelj anélkül, hogy a billentyűzetre néznél.",
                 "A gépelési rutin csökkenti a mentális terhelést.",
                 "Gyorsabban hozhatsz létre tartalmat.",
                 "A ritmusos gépelés javítja a szöveg áramlását.",
                 "A tapasztalt gépelők menet közben javítanak hibát.",
                 "Hosszú írás közben is fenntartható a koncentráció.",
                 "A billentyűparancsok növelik a hatékonyságot.",
                 "A gyors gépelés támogatja az együttműködést.",
                 "A gépelési készség fokozza a multitasking képességet.",
                 "A gépelés gyakorlása növeli az önbizalmat.",
                 "A gyakorlott gépelők szinte automatikusan írnak.",
                 "A gyors gépelés a digitális kommunikáció alapja."
      ]
    }
  };

  function setLanguage(lang){
    const allowed = ['en','hu','de'];
    currentLang = allowed.includes(lang) ? lang : 'en';
    localStorage.setItem('lang', currentLang);
    document.documentElement.lang = currentLang;

    const sel = document.getElementById('langSelect');
    if (sel) sel.value = currentLang;

    // aktív jelölés a zászlóknál
    document.querySelectorAll('.langbar a').forEach(a=>{
      a.classList.toggle('active', a.dataset.lang === currentLang);
    });
  }

  function startTest() {
    const level = document.getElementById("levelSelect").value;
    const duration = parseInt(document.getElementById("durationSelect").value);
    const sentencePool = sentences[currentLang]?.[level];

    if (!sentencePool || sentencePool.length === 0) {
      alert("No sentences available for selected language/level.");
      return;
    }

    currentSentence = sentencePool[Math.floor(Math.random() * sentencePool.length)];
    document.getElementById("sentenceDisplay").textContent = currentSentence;

    const inputArea = document.getElementById("inputArea");
    inputArea.value = "";
    inputArea.classList.remove("hidden");
    inputArea.focus();

    document.getElementById("finishBtn").classList.remove("hidden");
    document.getElementById("resultDisplay").textContent = "";
    document.getElementById("timerDisplay").textContent = "";

    clearInterval(timerInterval);
    let timeLeft = duration;
    document.getElementById("timerDisplay").textContent = timeLeft + "s";
    startTime = Date.now();

    timerInterval = setInterval(() => {
      timeLeft--;
      document.getElementById("timerDisplay").textContent = timeLeft + "s";
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        finishTest();
      }
    }, 1000);

    inputArea.oninput = function(){
      const typed = inputArea.value.trim();
      if (typed === currentSentence.trim()) {
        clearInterval(timerInterval);
        finishTest();
      }
    };
  }

  function finishTest() {
    clearInterval(timerInterval);
    const typedText = document.getElementById("inputArea").value;
    const wordsTyped = typedText.trim().split(/\s+/).filter(w => w.length > 0).length;
    const timeTaken = (Date.now() - startTime) / 1000 / 60;
    const wpm = Math.round(wordsTyped / timeTaken);

    let correctChars = 0;
    for (let i = 0; i < Math.min(typedText.length, currentSentence.length); i++) {
      if (typedText[i] === currentSentence[i]) correctChars++;
    }
    const accuracy = Math.round((correctChars / currentSentence.length) * 100);
    document.getElementById("resultDisplay").textContent = `WPM: ${wpm}, Accuracy: ${accuracy}%`;
    document.getElementById("finishBtn").classList.add("hidden");
    document.getElementById("inputArea").classList.add("hidden");

    /* Mentés + táblázat frissítés */
    const level = document.getElementById("levelSelect").value;
    const duration = parseInt(document.getElementById("durationSelect").value);
    saveResult({
      date: new Date().toLocaleString(),
      lang: currentLang,
      level,
      duration,  // másodperc
      wpm,
      accuracy
    });
    renderResults();
  }

  /* Eredménykezelő (localStorage) */
  const RESULTS_KEY = 'tsh_results_v1';

  function saveResult(record){
    const list = loadResults();
    list.unshift(record);
    localStorage.setItem(RESULTS_KEY, JSON.stringify(list.slice(0, 200)));
  }

  function loadResults(){
    try { return JSON.parse(localStorage.getItem(RESULTS_KEY) || '[]'); }
    catch(e){ return []; }
  }

  function renderResults(){
    const tbody = document.querySelector('#resultsTable tbody');
    if (!tbody) return;
    const rows = loadResults();
    tbody.innerHTML = rows.map(r => `
      <tr>
        <td>${escapeHtml(r.date)}</td>
        <td>${String(r.lang).toUpperCase()}</td>
        <td>${escapeHtml(r.level)}</td>
        <td>${formatDuration(r.duration)}</td>
        <td>${r.wpm}</td>
        <td>${r.accuracy}%</td>
      </tr>
    `).join('');
  }

  function exportResultsCSV(){
    const rows = loadResults();
    const header = ['date','lang','level','duration_s','wpm','accuracy'];
    const csv = [header.join(',')].concat(
      rows.map(r => [
        safeCsv(r.date),
        safeCsv(r.lang),
        safeCsv(r.level),
        r.duration,
        r.wpm,
        r.accuracy
      ].join(','))
    ).join('\n');
    const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = 'typing_results_' + new Date().toISOString().slice(0,10) + '.csv';
    document.body.appendChild(a); a.click();
    a.remove(); URL.revokeObjectURL(url);
  }

  function clearResults(){
    if (confirm('Delete all saved results?')) {
      localStorage.removeItem(RESULTS_KEY);
      renderResults();
    }
  }

  function formatDuration(sec){
    const s = Number(sec)||0;
    return s % 60 === 0 ? `${s/60}m` : `${s}s`;
  }
  function escapeHtml(s){
    return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
  }
  function safeCsv(s){
    const t = String(s).replace(/"/g,'""');
    return /[",\n]/.test(t) ? `"${t}"` : t;
  }

  // Zászlók: azonnali váltás + URL frissítése, oldal-újratöltés nélkül
  document.querySelectorAll('.langbar a').forEach(a=>{
    a.addEventListener('click', (e)=>{
      e.preventDefault();
      const lang = a.dataset.lang;
      setLanguage(lang);
      const url = new URL(location);
      url.searchParams.set('lang', lang);
      history.replaceState(null, "", url);
    });
  });

  // Inicializálás: URL > localStorage > böngésző nyelv
  (function(){
    const urlLang = new URLSearchParams(location.search).get('lang');
    const saved   = localStorage.getItem('lang');
    const guess   = (navigator.language || 'en').slice(0,2);
    const init    = urlLang || saved || (['en','hu','de'].includes(guess) ? guess : 'en');
    setLanguage(init);
    renderResults(); // eredmények megjelenítése betöltéskor
  })();
  </script>
</body>
</html>
